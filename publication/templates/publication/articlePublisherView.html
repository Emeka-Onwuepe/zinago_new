{% extends 'publication/base.html' %} {% block nav %}

<form action="{% url 'publication:editview' article.id 'view' %}" method="post">
    {% csrf_token %}
    <button type="submit">Edit</button>
</form>
<form action="{% url 'users:logoutView' %}" method="post">
    {% csrf_token %}
    <button type="submit">Sign Out</button>
</form>
{% endblock nav %} {% block main %}
<article class="article" >
    {% if messages %} {% for message in messages %}
    <p style="color: green">{{ message }}</p>
    {% endfor %} {% endif %}
    <h1 id="mainHeading">{{article.title}}</h1>
    {% if article.image %}
    <figure class="">
        <img src="{{article.image.url}}" alt="">
        <figcaption><em>Image Source: {{article.image_source}}</em></figcaption>
    </figure>
    {% endif %}
    <section>
        {% if article.sub_heading %}
        <h2 class="">{{article.sub_heading}}</h2>
        {% endif %} {{article.body_text|safe}}
    </section>
    
    <p class="pub_date">Date of Publication: {{article.mod_date}}</p>

    {% comment %} <a target="blank" href="{% url 'frontview:articleView' article.id article.title_slug %}">VIEW IN MAIN SITE</a> {% endcomment %}
    {% if article.publish %}
    <form action="{% url 'publication:articleWithdrawView' article.id %}" method="post">
        {% csrf_token %}
        <button class="submitButton publishButton" type="submit" onclick="return
            confirm('Are you sure you want to withdraw this article ?')">Withdraw</button>
    </form>
    
    {% else %} {% if form %} 
    <div class="publishbox">
        <form action="{% url 'publication:publishView' article.id article.title_slug %}" method="post">
            {% csrf_token %} {{form}}
            <button class="submitButton publishButton" type="submit">Publish</button>
        </form>
    </div>
    {% endif %} {% endif %}
</article>
<script>
    hidePublishButton()

    function hidePublishButton() {
        let checkBox = document.querySelector("#id_publish")
        let button = document.querySelector(".publishButton")
        if (checkBox.checked) {
            button.disabled = false
            button.style.backgroundColor = "#0978c6"
        } else {
            button.disabled = true
            button.style.backgroundColor = "gray";
        }
        checkBox.addEventListener("change", () => {
            if (checkBox.checked) {
                button.disabled = false
                button.style.backgroundColor = "#0978c6"
            } else {
                button.disabled = true
                button.style.backgroundColor = "gray";
            }
        })

    }
</script>
{% endblock main %}